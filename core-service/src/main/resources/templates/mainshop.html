<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{layout/default}">

<head>
    <title>SKU STORE - Home</title>
</head>

<body>
    <div layout:fragment="content">
        <div class="w-full">

        <!-- Category View -->
        <div th:if="${selectedCategory != null}" class="max-w-[1200px] mx-auto px-4 py-10">
            <h2 class="text-3xl font-black mb-8" th:text="${selectedCategory} + ' PRODUCTS'">CATEGORY</h2>
            <div class="grid grid-cols-4 gap-x-5 gap-y-8">
                <div th:each="item : ${categoryProducts}" class="group cursor-pointer"
                    th:onclick="'location.href=\'/product/' + ${item.id} + '\''">
                    <div class="w-full aspect-square bg-[#f4f4f4] mb-4 overflow-hidden relative rounded-sm">
                        <img th:src="${item.imageUrl}"
                            class="w-full h-full object-cover transition-transform duration-500 ease-out group-hover:scale-105"
                            alt="product">
                    </div>
                    <div class="pr-2">
                        <span class="block text-[13px] font-bold text-black mb-1 underline underline-offset-2"
                            th:text="${item.brand}">Brand</span>
                        <div class="text-sm text-dark-gray mb-2 leading-snug" th:text="${item.name}">Product Name</div>
                        <div class="flex items-center gap-1.5">
                            <span class="text-base font-extrabold text-black"
                                th:text="${item.price} + '원'">10,000원</span>
                        </div>
                    </div>
                </div>
            </div>
            <div th:if="${#lists.isEmpty(categoryProducts)}" class="text-center py-20 text-gray">
                <i class="ph ph-warning-circle text-4xl mb-2"></i>
                <p>해당 카테고리에 등록된 상품이 없습니다.</p>
            </div>
        </div>

        <!-- Main View (Rankings & Sections) -->
        <div th:unless="${selectedCategory != null}">
            <!-- Hero Banner -->
            <!-- Hero Banner Carousel -->
            <div class="h-[400px] mx-[3%] mt-[1%] mb-16 rounded-[15px] relative overflow-hidden group">
                <!-- Carousel Track -->
                <div id="bannerTrack" class="flex h-full transition-transform duration-700 ease-in-out translate-x-0">

                    <!-- Slide 1 -->
                    <div class="min-w-full h-full relative">
                        <div class="absolute inset-0 bg-cover bg-center transition-transform duration-700 hover:scale-105"
                            style="background-image: url('/image/herobanner/banner1.jpg');"></div>
                        <div class="absolute inset-0 bg-black/40"></div> <!-- Dark Overlay -->
                        <div
                            class="absolute inset-0 flex flex-col items-center justify-center text-center text-white z-10">
                            <h2 class="text-[56px] font-black leading-[1.1] mb-5 tracking-tighter drop-shadow-lg">
                                WINTER<br>COLLECTION</h2>
                            <p class="text-xl font-medium opacity-90 tracking-widest drop-shadow-md">최대 80% 시즌 오프 · SKU
                                STORE EXCLUSIVE</p>
                        </div>
                    </div>

                    <!-- Slide 2 -->
                    <div class="min-w-full h-full relative">
                        <div class="absolute inset-0 bg-cover bg-center transition-transform duration-700 hover:scale-105"
                            style="background-image: url('/image/herobanner/banner2.jpg');"></div>
                        <div class="absolute inset-0 bg-black/40"></div> <!-- Dark Overlay -->
                        <div
                            class="absolute inset-0 flex flex-col items-center justify-center text-center text-white z-10">
                            <h2 class="text-[56px] font-black leading-[1.1] mb-5 tracking-tighter drop-shadow-lg">
                                MERRY<br>CHRISTMAS</h2>
                            <p class="text-xl font-medium opacity-90 tracking-widest drop-shadow-md">특별한 연말 선물 · HOLIDAY
                                SPECIAL</p>
                        </div>
                    </div>

                </div>

                <!-- Indicators -->
                <div class="absolute bottom-5 left-0 right-0 flex justify-center gap-2 z-20">
                    <button onclick="goToSlide(0)"
                        class="w-2 h-2 rounded-full bg-white opacity-100 transition-all indicator"></button>
                    <button onclick="goToSlide(1)"
                        class="w-2 h-2 rounded-full bg-white/50 hover:bg-white transition-all indicator"></button>
                </div>
            </div>

            <script>
                let currentSlide = 0;
                const totalSlides = 2;
                const track = document.getElementById('bannerTrack');
                const indicators = document.querySelectorAll('.indicator');
                let slideInterval;

                function updateSlide() {
                    track.style.transform = `translateX(-${currentSlide * 100}%)`;

                    // Update indicators
                    indicators.forEach((ind, index) => {
                        if (index === currentSlide) {
                            ind.classList.remove('bg-white/50');
                            ind.classList.add('bg-white', 'w-6'); // Active state
                        } else {
                            ind.classList.add('bg-white/50');
                            ind.classList.remove('bg-white', 'w-6');
                        }
                    });
                }

                function nextSlide() {
                    currentSlide = (currentSlide + 1) % totalSlides;
                    updateSlide();
                }

                function goToSlide(index) {
                    currentSlide = index;
                    updateSlide();
                    resetInterval();
                }

                function resetInterval() {
                    clearInterval(slideInterval);
                    slideInterval = setInterval(nextSlide, 5000); // 5 seconds
                }

                // Start auto-slide
                resetInterval();
            </script>

            <!-- Ranking Section -->
            <div class="flex justify-between items-end mb-8 pb-4 border-b-2 border-black mx-[3%]">
                <h3 class="text-2xl font-extrabold text-black tracking-tight">실시간 랭킹</h3>
            </div>

            <div class="grid grid-cols-5 gap-x-5 gap-y-8 mb-24 mx-[3%]">
                <div th:each="item, stat : ${rankings}" class="group cursor-pointer"
                    th:onclick="'location.href=\'/product/' + ${item.id} + '\''">
                    <div class="w-full aspect-[3/4] bg-[#f4f4f4] mb-4 overflow-hidden relative rounded-sm">
                        <div class="absolute top-0 left-0 bg-black text-white w-9 h-9 flex items-center justify-center font-extrabold text-lg z-10"
                            th:text="${stat.count}">1</div>
                        <img th:src="${item.imageUrl}"
                            class="w-full h-full object-cover transition-transform duration-500 ease-out group-hover:scale-105"
                            alt="product">
                    </div>
                    <div class="pr-2">
                        <span class="block text-[13px] font-bold text-black mb-1 underline underline-offset-2"
                            th:text="${item.brand}">Brand</span>
                        <div class="text-sm text-dark-gray mb-2 leading-snug h-10 overflow-hidden line-clamp-2"
                            th:text="${item.name}">Product Name</div>
                        <div class="flex items-center gap-1.5">
                            <span class="text-base font-extrabold text-black"
                                th:text="${item.price} + '원'">10,000원</span>
                            <span class="text-base font-extrabold text-danger" th:if="${item.discountRate > 0}"
                                th:text="${item.discountRate} + '%'">10%</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tech Section -->
            <div class="flex justify-between items-end mb-8 pb-4 border-b-2 border-black mx-[3%]">
                <h3 class="text-2xl font-extrabold text-black tracking-tight">테크 특가</h3>
                <a href="/mainshop?category=TECH"
                    class="text-sm text-gray font-semibold hover:text-black transition-colors">더보기 ></a>
            </div>
            <div class="grid grid-cols-4 gap-x-5 gap-y-8 mb-24 mx-[3%]">
                <div th:each="item : ${techDeals}" class="group cursor-pointer"
                    th:onclick="'location.href=\'/product/' + ${item.id} + '\''">
                    <div class="w-full aspect-square bg-[#f4f4f4] mb-4 overflow-hidden relative rounded-sm">
                        <img th:src="${item.imageUrl}"
                            class="w-full h-full object-cover transition-transform duration-500 ease-out group-hover:scale-105"
                            alt="product">
                    </div>
                    <div class="pr-2">
                        <span class="block text-[13px] font-bold text-black mb-1 underline underline-offset-2"
                            th:text="${item.brand}">Brand</span>
                        <div class="text-sm text-dark-gray mb-2 leading-snug" th:text="${item.name}">Product Name</div>
                        <div class="flex items-center gap-1.5">
                            <span class="text-base font-extrabold text-black"
                                th:text="${item.price} + '원'">10,000원</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Food Section -->
            <div class="flex justify-between items-end mb-8 pb-4 border-b-2 border-black mx-[3%]">
                <h3 class="text-2xl font-extrabold text-black tracking-tight">푸드 특가</h3>
                <a href="/mainshop?category=FOOD"
                    class="text-sm text-gray font-semibold hover:text-black transition-colors">더보기 ></a>
            </div>
            <div class="grid grid-cols-4 gap-x-5 gap-y-8 mb-24 mx-[3%]">
                <div th:each="item : ${foodDeals}" class="group cursor-pointer"
                    th:onclick="'location.href=\'/product/' + ${item.id} + '\''">
                    <div class="w-full aspect-square bg-[#f4f4f4] mb-4 overflow-hidden relative rounded-sm">
                        <img th:src="${item.imageUrl}"
                            class="w-full h-full object-cover transition-transform duration-500 ease-out group-hover:scale-105"
                            alt="product">
                    </div>
                    <div class="pr-2">
                        <span class="block text-[13px] font-bold text-black mb-1 underline underline-offset-2"
                            th:text="${item.brand}">Brand</span>
                        <div class="text-sm text-dark-gray mb-2 leading-snug" th:text="${item.name}">Product Name</div>
                        <div class="flex items-center gap-1.5">
                            <span class="text-base font-extrabold text-black"
                                th:text="${item.price} + '원'">10,000원</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Fashion Section -->
            <div class="flex justify-between items-end mb-8 pb-4 border-b-2 border-black mx-[3%]">
                <h3 class="text-2xl font-extrabold text-black tracking-tight">패션 특가</h3>
                <a href="/mainshop?category=FASHION"
                    class="text-sm text-gray font-semibold hover:text-black transition-colors">더보기 ></a>
            </div>
            <div class="grid grid-cols-4 gap-x-5 gap-y-8 mb-24 mx-[3%]">
                <div th:each="item : ${fashionDeals}" class="group cursor-pointer"
                    th:onclick="'location.href=\'/product/' + ${item.id} + '\''">
                    <div class="w-full aspect-square bg-[#f4f4f4] mb-4 overflow-hidden relative rounded-sm">
                        <img th:src="${item.imageUrl}"
                            class="w-full h-full object-cover transition-transform duration-500 ease-out group-hover:scale-105"
                            alt="product">
                    </div>
                    <div class="pr-2">
                        <span class="block text-[13px] font-bold text-black mb-1 underline underline-offset-2"
                            th:text="${item.brand}">Brand</span>
                        <div class="text-sm text-dark-gray mb-2 leading-snug" th:text="${item.name}">Product Name</div>
                        <div class="flex items-center gap-1.5">
                            <span class="text-base font-extrabold text-black"
                                th:text="${item.price} + '원'">10,000원</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Home Section -->
            <div class="flex justify-between items-end mb-8 pb-4 border-b-2 border-black mx-[3%]">
                <h3 class="text-2xl font-extrabold text-black tracking-tight">홈/리빙 특가</h3>
                <a href="/mainshop?category=HOME"
                    class="text-sm text-gray font-semibold hover:text-black transition-colors">더보기 ></a>
            </div>
            <div class="grid grid-cols-4 gap-x-5 gap-y-8 mb-24 mx-[3%]">
                <div th:each="item : ${homeDeals}" class="group cursor-pointer"
                    th:onclick="'location.href=\'/product/' + ${item.id} + '\''">
                    <div class="w-full aspect-square bg-[#f4f4f4] mb-4 overflow-hidden relative rounded-sm">
                        <img th:src="${item.imageUrl}"
                            class="w-full h-full object-cover transition-transform duration-500 ease-out group-hover:scale-105"
                            alt="product">
                    </div>
                    <div class="pr-2">
                        <span class="block text-[13px] font-bold text-black mb-1 underline underline-offset-2"
                            th:text="${item.brand}">Brand</span>
                        <div class="text-sm text-dark-gray mb-2 leading-snug" th:text="${item.name}">Product Name</div>
                        <div class="flex items-center gap-1.5">
                            <span class="text-base font-extrabold text-black"
                                th:text="${item.price} + '원'">10,000원</span>
                        </div>
                    </div>
                </div>
            </div>

        </div>
        </div>
    </div>
</body>

</html>